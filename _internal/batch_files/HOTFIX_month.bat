@echo off
powershell.exe -Command "$UpdateSession = New-Object -ComObject Microsoft.Update.Session; $UpdateSearcher = $UpdateSession.CreateUpdateSearcher(); $historyCount = $UpdateSearcher.GetTotalHistoryCount(); $updates = $UpdateSearcher.QueryHistory(0, $historyCount); if ($updates.Count -gt 0) { $latestUpdate = $updates | Select-Object -First 1; $latestUpdateDate = [DateTime]$latestUpdate.Date; $oneMonthAgo = (Get-Date).AddMonths(-6); if ($latestUpdateDate -gt $oneMonthAgo) { Write-Host '양호'; Write-Host \"현재 상태: 최근 업데이트 날짜 $($latestUpdateDate)\"; } else { Write-Host '미흡'; Write-Host \"현재 상태: 최신 업데이트가 필요합니다. 최근 업데이트 날짜 $($latestUpdateDate)\"; Write-Host '조치 방법: 사내망 연결 > 시작 > [Windows 업데이트 설정] 입력 > 업데이트 확인 클릭 > Microsoft 업데이트에서 온라인으로 업데이트 확인'; } } else { Write-Host 'No updates found'; }"
